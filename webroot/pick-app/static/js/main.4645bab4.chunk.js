(this["webpackJsonppick-app"]=this["webpackJsonppick-app"]||[]).push([[0],{117:function(e,t,s){e.exports=s(223)},155:function(e,t,s){},223:function(e,t,s){"use strict";s.r(t);s(118);var a=s(0),i=s.n(a),l=s(111),n=s.n(l),c=(s(155),s(80)),o=s(115),r=s.n(o),h=s(116),p=s.n(h),m=s(46),d=s.n(m),g=s(112),u=s.n(g),k=s(113),E=s.n(k),S=s(114),f=s.n(S),w=s(79),b=s.n(w);s(156);class v extends a.Component{constructor(e){super(e),this.state={allPicked:!1,selectMessage:"Select a shipper",shipments:[],shipment:{},message:"",showAlert:!1},this.selectOnChange=this.selectOnChange.bind(this),this.fetchShipperPallets=this.fetchShipperPallets.bind(this),this.handleDismiss=this.handleDismiss.bind(this)}handleDismiss(){this.setState({showAlert:!this.state.showAlert})}togglePicked(e,t,s=!1){const a=this.props.baseUrl+"Pallets/multiEdit/";let i=JSON.parse(JSON.stringify(this.state.shipment.pallets)),l=[],n={};if(s)l=i.map((e,s)=>(i[s].picked=t,{id:e.id,picked:t})),n={allPicked:t};else{l=i.map((s,a)=>i[a].id===e?(i[a].picked=t,{id:s.id,picked:t}):null).filter(e=>e),n={allPicked:i.every((e,t)=>e.picked)}}let o=Object(c.a)({},this.state,{shipment:Object(c.a)({},this.state.shipment,{pallets:[...i]})},n);this.setState(o),fetch(a,{method:"POST",mode:"cors",credentials:"include",headers:{"X-CSRF-Token":window.csrfToken,Accept:"application/json","Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(l)}).then(e=>{if(e.ok)return e.json();throw new Error("Failed to POST to "+a+": "+e.status+" "+e.statusText)}).then(e=>{this.setState({message:e.message,messageResult:e.result,showAlert:!0},()=>{setTimeout(()=>{this.setState({showAlert:!1})},3e3)})}).catch(e=>{this.setState({message:e.message||"error updating picked status",messageResult:"danger",showAlert:!0})})}fetchShipperPallets(e){const t=this.props.baseUrl+"Shipments/view/";fetch(t+e,{method:"GET",mode:"cors",crendentials:"include",headers:{Accept:"application/json"}}).then(e=>{if(e.ok)return e.json();throw new Error("failed to request "+t)}).then(e=>{this.setState({shipment:e});const t=e.pallets.every(e=>e.picked);this.setState({allPicked:t})}).catch(e=>{})}selectOnChange(e){0!==parseInt(e.target.value)?this.fetchShipperPallets(e.target.value):this.setState({shipment:{}})}componentDidMount(){const e=this.props.baseUrl+"Shipments/openShipments";fetch(e,{method:"GET",mode:"cors",crendentials:"include",headers:{Accept:"application/json"}}).then(t=>{if(t.ok)return t.json();throw new Error("failed to request "+e+" "+t.status+" "+t.statusText)}).then(e=>{0===e.shipments.length?this.setState({selectMessage:"Reload the page to check for new shippers"}):this.setState(e)}).catch(e=>{console.log(e),this.setState({message:e.message,messageResult:"danger",showAlert:!0})})}render(){const e=this.state,t=e.shipments;let s=e.shipment.pallets,a=0,l=0;let n="label-warning",c=!1;return s&&(s.sort((function(e,t){return e.location.location<t.location.location?-1:e.location.location>t.location.location?1:0})),a=s.length,l=s.filter(e=>!0===e.picked).length,a===l&&(c=!0,n="label-success")),i.a.createElement("div",{className:"col"},i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col"},i.a.createElement(u.a,{controlId:"formControlsSelect"},i.a.createElement(E.a,null,"Select a shipper"),i.a.createElement(f.a,{onChange:this.selectOnChange,componentClass:"select",placeholder:"select"},i.a.createElement("option",{key:1,value:0},this.state.selectMessage),t.map((e,t)=>i.a.createElement("option",{key:e.id,value:e.id},e.shipper," ",e.destination)))))),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-lg-12 col-md-12 col-sm-12"},this.state.showAlert&&i.a.createElement(r.a,{onDismiss:this.handleDismiss,bsStyle:this.state.messageResult},this.state.message))),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-lg-12 col-md-12 col-sm-12"},s&&i.a.createElement(p.a,{as:"ul"},i.a.createElement(d.a,{key:0,as:"li",active:!0},i.a.createElement("h3",{className:"list-group-item-heading"},t.shipper,i.a.createElement("span",{style:{float:"right"},className:"label ".concat(n)},l,"/",a)),i.a.createElement("p",{className:"list-group-item-text"},t.destination),i.a.createElement(b.a,{checked:this.state.allPicked,onChange:e=>this.togglePicked(null,!this.state.allPicked,!0)},"Mark all as picked")),s.map((e,t)=>{const s=e.picked;let a="list-group-item";return s&&!c&&(a+=" list-group-item-info"),c&&(a+=" list-group-item-success"),i.a.createElement(d.a,{as:"li",className:a,key:e.id},i.a.createElement("h4",{className:"list-group-item-heading"},e.location.location),i.a.createElement("p",{className:"list-group-item-text"},e.pl_ref),i.a.createElement("p",{className:"list-group-item-text"}," ",e.item," ",e.description),i.a.createElement(b.a,{checked:s,onChange:t=>{this.togglePicked(e.id,t.target.checked)}},"Picked"))})))))}}var N=v;const P=document.getElementById("root"),y=P.getAttribute("data-baseurl");n.a.render(i.a.createElement(N,{baseUrl:y}),P)}},[[117,1,2]]]);
//# sourceMappingURL=main.4645bab4.chunk.js.map