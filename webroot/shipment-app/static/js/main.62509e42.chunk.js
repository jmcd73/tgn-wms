(this["webpackJsonpshipment-app"]=this["webpackJsonpshipment-app"]||[]).push([[0],{109:function(e,t,a){},111:function(e,t,a){},139:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(13),o=a.n(i),c=a(16),l=a(71),s=a(72),d=a(88),u=a(89),p=a(15),m=a(30),h=a(73),b=a.n(h),E=function(e){var t=e.loading;return t?r.a.createElement(m.a,null,r.a.createElement(p.a,{lg:12},r.a.createElement("div",{className:"text-center"},r.a.createElement(b.a,{loading:t,size:14,color:"#ddd"})))):r.a.createElement(r.a.Fragment,null)},f=a(20),g=function(e){return r.a.createElement(r.a.Fragment,null,e.children)},y=a(87),O=(a(109),a(146)),T=function(e){var t=e.onDismiss,a=e.content,n=a.alertVariant,i=a.alertTextBold,o=a.alertText,c=a.showAlert;return r.a.createElement(O.a,{in:c,timeout:300,classNames:"toggen",unmountOnExit:!0},r.a.createElement(y.a,{variant:n,onClose:t,dismissible:!0},r.a.createElement("strong",null,i," ")," ",o))},v=(a(110),a(111),a(27)),D=a(49);function _(e){var t=e.selectedCount,a=e.children;return r.a.createElement(v.a,null,r.a.createElement(v.a.Header,{as:"h5"},"Currently On Shipment ",r.a.createElement(D.a,{variant:"primary"},t)),r.a.createElement(v.a.Body,null,a))}var j=a(9),S=a(23),A=a(76),L=a(75),I=a(85),C=a(52),k=r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,"This pallet doesn't have enough days product life left before it expires to allow it to ship.")),P=function(e){var t=e.placement;return r.a.createElement(C.a,Object.assign({},e,{id:"popover-positioned-".concat(t)}),r.a.createElement(C.a.Title,null,"Low Dated Stock"),r.a.createElement(C.a.Content,null,k))},w=function(e){var t=e.disabled,a=e.children,n=e.childKey;return t?r.a.createElement(I.a,{placement:"bottom",trigger:"click",rootClose:!0,overlay:P},r.a.createElement("span",{key:n},a)):a},x=a(21),R="ADD_ALL_PALLETS",N="ADD_OPERATION_NAME",U="ADD_OPERATION",V="ADD_PRODUCT_TYPE_ID",H="HIDE_ALERT",B="LOAD_OPTIONS",M="SET_IS_EXPANDED",X="SET_LABEL_IDS",F="SET_LABEL_LIST",q="SET_LOADING",G="SET_PRODUCT_DESCRIPTIONS",K="SET_PRODUCT_TYPE_NAME",W="SET_PRODUCTS",Y="SET_TYPEAHEAD_LOADING",J="SHOW_ALERT",z="TOGGLE_ALERT",Q="UPDATE_BASE_URL",Z="SET_SHIPMENT_DETAIL",$="TOGGLE_SHIPPED",ee="UPDATE_IS_EXPANDED",te="UPDATE_ITEM_COUNTS",ae="UPDATE_PRODUCTS",ne="UPDATE_PRODUCT_DESCRIPTIONS",re="UPDATE_CODE_DESCRIPTIONS",ie="UPDATE_UI",oe="SUBMIT_START",ce="UPDATE_ERRORS",le="ADD_SHIPMENT_FROM_FETCH",se={loadProductsAndDescriptions:function(e){var t=[],a={},n={};e.forEach((function(r){-1===t.indexOf(r.item_id)&&(t.push(r.item_id),a[r.item_id]=r.code_desc,n=Object(j.a)({},n,{},se.updateSingleItemLabelCount(e,r.item_id)))}));var r=t.reduce((function(e,t,a){return e[t]=!1,e}),{});return{products:t,productDescriptions:a,isExpanded:r,itemCounts:n}},updateCodeDescriptions:function(e){return function(t,a){t({type:re});var n=a().products,r=n.products,i=n.allPallets,o=i.filter((function(t){return parseInt(t.id)===parseInt(e)}))[0],c=o.item_id,l=o.code_desc;t({type:te,data:se.updateSingleItemLabelCount(i,c)}),-1===r.indexOf(c)&&(t({type:ee,data:Object(x.a)({},c,!1)}),t({type:ae,data:c}),t({type:ne,data:Object(x.a)({},c,l)}))}},updateSingleItemLabelCount:function(e,t){var a=e.filter((function(e,a){return e.item_id===t})).length;return Object(x.a)({},t,a)},getLabelList:function(e,t){var a=t.reduce((function(t,a,n){return a.item_id===e&&t.push(a),t}),[]);return Object(x.a)({},e,a)},toggleIsExpanded:function(e,t){return Object.keys(t).forEach((function(a){parseInt(a)===parseInt(e)?t[a]=!t[a]:t[a]=!1})),t},toggleAlert:function(e,t,a){var n=this,r=!this.state.showAlert;this.setState({alertVariant:a,alertText:e,alertTextBold:t,showAlert:r}),r&&setTimeout((function(){n.setState({showAlert:!r})}),4e3)},addRemoveLabel:function(e,t,a){return e&&-1===a.indexOf(t)&&a.push(t),e||(a=a.filter((function(e){return e!==t}))),a},parseRouterArgs:function(e){return{operation:e.operation,productTypeOrId:e.productTypeOrId}},getValidationState:function(e,t){return void 0!==t[e]},formatErrors:function(e,t){var a=[];if(t[e]){var n=t[e];a=Object.keys(n).map((function(e){return n[e]}))}return a.join(", ")},getLabelObject:function(e,t){return t.filter((function(t,a){return t.id===e}))[0]},buildLabelString:function(e){var t=e.location,a=e.item,n=e.bb_date,r=e.pl_ref,i=e.qty,o=e.description;return[t.location,a,new Date(n).toLocaleDateString(),r,i,o].join(", ")}},de=se,ue=function(e){return{type:Y,data:e}},pe=function(e,t){return{type:Z,data:{fieldName:e,fieldValue:t}}},me=function(e){return{type:X,data:e}},he=function(e,t){return function(a,n){var r=n().shipment.labelIds;r=de.addRemoveLabel(e,t,r),a(me(r)),a(de.updateCodeDescriptions(t))}},be=Object(c.b)((function(e){return Object(j.a)({},e)}),(function(e){return{addRemoveLabel:function(t,a){e(he(t,a))}}}))((function(e){var t=e.labelLists,a=e.productId,n=e.labelIds,i=e.addRemoveLabel;return t[a].map((function(e,t){var a=null,o=n.indexOf(e.id)>-1,c={};e.disabled&&(a=r.a.createElement(L.a,{icon:A.a}),c={pointerEvents:"none"});var l=de.buildLabelString(e);return r.a.createElement(w,{key:e.pl_ref,childKey:e.pl_ref,disabled:e.disabled},r.a.createElement(S.a.Check,{disabled:e.disabled,style:c,key:e.pl_ref,id:e.pl_ref},r.a.createElement(S.a.Check.Input,{checked:o,isInvalid:e.disabled,type:"checkbox",onChange:function(t){return i(t.target.checked,e.id)}}),r.a.createElement(S.a.Check.Label,null,a," ",l)))}))})),Ee=Object(c.b)((function(e){var t=e.products;return{isExpanded:e.ui.isExpanded,products:t.products,allPallets:t.allPallets,labelLists:t.labelLists,labelCounts:t.labelCounts,productDescriptions:t.productDescriptions}}),(function(e){return{getLabelList:function(t,a){return e({type:F,data:de.getLabelList(t,a)})},toggleIsExpanded:function(t,a){e({type:M,data:de.toggleIsExpanded(t,a)})}}}))((function(e){var t=e.labelCounts,a=e.products,n=e.labelIds,i=e.getLabelList,o=e.toggleIsExpanded,c=e.isExpanded,l=e.labelLists,s=e.productDescriptions,d=e.allPallets,u=null;return a&&(u=a.map((function(e,a){var u=null;return l[e]&&c[e]&&(u=r.a.createElement(v.a.Body,{className:c[e]},r.a.createElement(be,{labelLists:l,labelIds:n,productId:e}))),r.a.createElement("div",{key:"wrap-".concat(a)},r.a.createElement(v.a.Header,{onClick:function(){i(e,d),o(e,c)},as:"h5",className:"toggen-header",key:"header-{idx}"}," ",s[e]," ",t[e]&&r.a.createElement(D.a,{variant:"primary"},t[e])),u)}))),r.a.createElement(v.a,{key:"card-top-level"},u)})),fe=a(77),ge=function(e){var t=e.click;return r.a.createElement(fe.a,{variant:"primary",size:"sm",className:"my-btn",onClick:function(){t()},type:"submit"},"Submit")},ye=a(26),Oe=Object(c.b)((function(e){var t=e.shipment,a=e.products;return{labelIds:t.labelIds,allPallets:a.allPallets}}),(function(e){return{addRemoveLabel:function(t,a,n){e(he(t,a))}}}))((function(e){var t=e.labelIds,a=e.allPallets,n=e.addRemoveLabel;return t?t.map((function(e){var t=de.getLabelObject(e,a);return r.a.createElement(ye.a,{key:t.pl_ref,id:"checkbox-{id}",checked:!0,label:de.buildLabelString(t),onChange:function(e){return n(e.target.checked,t.id)}})})):null})),Te={fetchData:function(e,t,a){return function(n){n({type:q});var r=[e,t].filter((function(e){return e})),i="".concat(a,"Shipments/")+r.join("/");return fetch(i,{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}}).then((function(e){return e.json()})).then((function(r){var i,o=[],c="",l=t;switch(n({type:U,data:e}),e){case"add-shipment":c="Add",o=r.shipment_labels,n({type:N,data:c}),n({type:V,data:l}),n({type:R,data:o});break;case"edit-shipment":c="Edit";var s=r.shipment.pallets;o=s.concat(r.shipment_labels),n(function(e){return{type:N,data:e}}(c)),n(function(e){return{type:R,data:e}}(o));var d=s.map((function(e){return e.id}));l=r.shipment.product_type_id,n(function(e){return{type:V,data:e}}(l)),n((i=r.shipment,{type:le,data:i})),n(me(d))}n(Te.fetchProductType(l,a));var u=de.loadProductsAndDescriptions(o),p=u.products,m=u.productDescriptions,h=u.isExpanded,b=u.itemCounts;n({type:te,data:b}),n({type:W,data:p}),n({type:G,data:m}),n({type:M,data:h}),n({type:q,data:!1})})).catch((function(e){return console.log(e)}))}},submitData:function(){return function(e,t){e({type:ie,data:{errors:{},loading:!0}});var a=t(),n=a.products,r=a.ui,i=a.shipment,o=i.operation,c=i.shipper,l=i.shipped,s=i.id,d=i.destination,u=i.labelIds,p=r.baseUrl,m=n.productType,h={shipper:c,destination:d,shipped:l,product_type_id:m,pallets:u},b="";switch(o){case"add-shipment":b=m;break;case"edit-shipment":b=s,h.id=s;var E=u.map((function(e){return{shipment_id:s,id:e}}));h=Object(j.a)({},h,{pallets:E});break;default:console.log("it broken")}var f=p+"Shipments/"+[o,b].filter((function(e){return e})).join("/"),g={method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"X-CSRF-Token":window.csrfToken,"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest"},redirect:"error",body:JSON.stringify(h)};return e({type:oe}),fetch(f,g).then((function(e){return e.json()})).then((function(t){var a=!0,n=t.error||{};Object.keys(n).length>0&&(n.pallets&&function e(t,a){for(var n in t)a.apply(this,[n,t[n]]),null!==t[n]&&"object"==typeof t[n]&&e(t[n],a)}(n=n.pallets,(function(e,t){"shipped"===e&&(n=Object(x.a)({},e,t))})),Object.keys(n).forEach((function(t){e({type:ce,data:Object(x.a)({},t,n[t])})})),a=!1),e({type:ie,data:{loading:!1,redirect:a}})}))}},fetchProductType:function(e,t){return function(a){var n="".concat(t,"ProductTypes/view/").concat(e);if(e)return a({type:"FETCH_PRODUCT_START"}),fetch(n,{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}}).then((function(e){return e.json()})).then((function(e){e.productType&&a({type:K,data:e.productType.name})})).catch((function(e){throw e}))}},getSearchTerm:function(e){return function(t,a){t({type:Y,data:!0}),t({type:"START_FETCH_TYPEAHEAD"});var n=a().ui.baseUrl;return fetch("".concat(n,"Shipments/destinationLookup?term=").concat(e),{headers:{Accept:"application/json"}}).then((function(e){return e.json()})).then((function(e){t({type:Y,data:!1}),t({type:B,data:e})}))}}},ve=Te,De=a(29),_e=Object(c.b)((function(e){var t=e.shipment,a=e.ui;return{shipped:t.shipped,errors:a.errors}}),(function(e){return{toggleShipped:function(){e({type:$})}}}))((function(e){var t=e.toggleShipped,a=e.getValidationState,n=e.shippedError,i=e.shipped,o=e.errors;return r.a.createElement(De.a,null,r.a.createElement(S.a.Check,{id:"shipped"},r.a.createElement(S.a.Check.Input,{type:"checkbox",checked:i,onChange:t,isValid:a("shipped",o)}),r.a.createElement(S.a.Check.Label,null,"Shipped"),r.a.createElement(S.a.Control.Feedback,null,n)))})),je=a(41),Se=a(42),Ae=a(43),Le=a(86),Ie=a(19),Ce=Object(c.b)((function(e){var t=e.ui,a=e.shipment;return{isTypeAheadLoading:t.isTypeAheadLoading,baseUrl:t.baseUrl,errors:t.errors,options:t.options,shipper:a.shipper,destination:a.destination,shipped:a.shipped}}),(function(e){return Object(Ie.b)({setTypeaheadLoadingState:ue,getSearchTerm:ve.getSearchTerm,setShipmentDetail:pe,submitOnEnter:ve.submitData},e)}))((function(e){var t=e.formatErrors,a=e.setShipmentDetail,n=e.isTypeAheadLoading,i=e.getSearchTerm,o=e.errors,c=e.options,l=e.destination,s=e.submitOnEnter,d=e.shipper;return r.a.createElement(S.a.Row,{onSubmit:function(e){return e.preventDefault()}},r.a.createElement(p.a,{lg:3},r.a.createElement(De.a,{controlId:"shipper"},r.a.createElement(Se.a,null,"Shipment")," ",r.a.createElement(je.a,{type:"text",value:d,onKeyDown:function(e){"Enter"===e.key&&s()},isValid:de.getValidationState("shipper",o),placeholder:"Shipment",onChange:function(e){a(e.target.id,e.target.value)},required:"required"}),r.a.createElement(je.a.Feedback,null),r.a.createElement(Ae.a,null,t("shipper",o)))),r.a.createElement(p.a,{lg:3,key:"row-col-2"},r.a.createElement(De.a,{controlId:"destination"},r.a.createElement(Se.a,null,"Destination"),r.a.createElement(Le.a,{minLength:1,placeholder:"Destination",isLoading:n,id:"destination",isValid:de.getValidationState("destination",o),selected:[l],onChange:function(e){if(e.length>0){var t=e[0].value;a("destination",t)}},onInputChange:function(e){a("destination",e)},onSearch:function(e){i(e)},labelKey:"value",options:c,onKeyDown:function(e){"Enter"===e.key&&s()}}),r.a.createElement(Ae.a,null,t("destination",o)))))})),ke=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"componentDidMount",value:function(){var e=de.parseRouterArgs(this.props.match.params),t=e.operation,a=e.productTypeOrId,n=this.props,r=n.baseUrl,i=n.fetchData;(0,n.updateBaseUrl)(r),i(t,a,r)}},{key:"render",value:function(){var e=this.props,t=e.products,a=e.productDescriptions,n=e.labelLists,i=e.showAlert,o=e.labelCounts,c=e.toggleAlert,l=e.isExpanded,s=e.productTypeName,d=e.loading,u=e.baseUrl,h=e.redirect,b=e.operationName,f=e.options,y=e.alert,O=e.errors,v=e.submitData,D=e.isTypeAheadLoading,j=e.labelIds;return h&&(window.location=u+"Shipments/"),r.a.createElement(g,null,r.a.createElement(m.a,{key:"row-1"},r.a.createElement(p.a,{lg:12},r.a.createElement(T,{content:y,onDismiss:c}),r.a.createElement("h3",null,b," ",s," Shipment"))),r.a.createElement(m.a,{key:"row-2"},r.a.createElement(p.a,{lg:12,key:"row-col-1"},r.a.createElement(Ce,{options:f,getValidationState:de.getValidationState,isTypeAheadLoading:D,formatErrors:de.formatErrors}))),r.a.createElement(m.a,{key:"row-3"},r.a.createElement(p.a,{lg:6},r.a.createElement(_e,{toggleShipped:this.toggleShipped,getValidationState:de.getValidationState,shippedError:de.formatErrors("shipped",O)})),r.a.createElement(p.a,{lg:1,className:"mb-3"},r.a.createElement(ge,{click:v,showAlert:i})),r.a.createElement(p.a,{lg:5},r.a.createElement(E,{loading:d}))),r.a.createElement(m.a,{key:"row-4"},r.a.createElement(p.a,null,r.a.createElement("div",{className:"pre-scrollable"},r.a.createElement("div",{className:"card-container"},r.a.createElement(Ee,{labelLists:n,isExpanded:l,labelCounts:o,products:t,labelIds:j,productDescriptions:a})))),r.a.createElement(p.a,null,r.a.createElement(_,{selectedCount:j.length},r.a.createElement(Oe,{count:j.length})))))}}]),a}(r.a.Component),Pe={submitData:ve.submitData,fetchData:ve.fetchData,toggleAlert:function(){return{type:z}},showAlert:function(e,t,a){return{type:J,data:{alertTextBold:e,alertText:t,alertVariant:a}}},updateBaseUrl:function(e){return{type:Q,data:e}}},we=Object(c.b)((function(e){var t=e.shipment,a=e.ui,n=e.products;return{alert:e.alert,labelIds:t.labelIds,labelCounts:n.labelCounts,errors:a.errors,products:n.products,productDescriptions:n.productDescriptions,labelLists:n.labelLists,isExpanded:a.isExpanded,productTypeName:n.productTypeName,loading:a.loading,options:a.options,redirect:a.redirect,operationName:a.operationName,isTypeAheadLoading:a.isTypeAheadLoading}}),(function(e){return Object(Ie.b)(Pe,e)}))(Object(f.f)(ke)),xe=a(84),Re={operation:"",id:"",shipment_type:"",shipped:!1,shipper:"",destination:"",product_type_id:"",labelIds:[]};var Ne={showAlert:!1,alertTextBold:"Default Alert Bold",alertText:"Default alert text",alertVariant:"info"};var Ue={products:[],productDescriptions:{},labelLists:{},labelCounts:{},productType:0,productTypeName:"",allPallets:[],productTypes:[]};var Ve={isExpanded:{},options:[],redirect:!1,loading:!1,errors:{},operationName:"",isTypeAheadLoading:!1,baseUrl:""};var He=Object(Ie.c)({shipment:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Re,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case U:return Object(j.a)({},e,{operation:t.data});case X:return Object(j.a)({},e,{labelIds:t.data});case le:return Object(j.a)({},e,{},t.data);case Z:var a=t.data,n=a.fieldName,r=a.fieldValue;return Object.assign({},e,Object(x.a)({},n,r));case $:return Object(j.a)({},e,{shipped:!e.shipped});default:return e}},alert:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ne,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case z:return Object(j.a)({},e,{showAlert:!e.showAlert});case J:return Object(j.a)({},e,{showAlert:!0},t.data);case H:return Object(j.a)({},e,{showAlert:!1});default:return e}},products:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ue,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case F:return Object(j.a)({},e,{labelLists:Object(j.a)({},e.labelLists,{},t.data)});case V:return Object(j.a)({},e,{productType:t.data});case W:return Object(j.a)({},e,{products:t.data});case K:return Object(j.a)({},e,{productTypeName:t.data});case G:return Object(j.a)({},e,{productDescriptions:t.data});case ne:return Object(j.a)({},e,{products:Object(j.a)({},e.products,{},t.data)});case te:return Object(j.a)({},e,{labelCounts:Object(j.a)({},e.labelCounts,{},t.data)});case R:return Object(j.a)({},e,{allPallets:t.data});default:return e}},ui:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ve,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case M:return Object(j.a)({},e,{isExpanded:t.data});case ie:return Object(j.a)({},e,{},t.data);case ce:return Object(j.a)({},e,{errors:Object(j.a)({},e.errors,{},t.data)});case ee:return Object(j.a)({},e,{isExpanded:Object(j.a)({},e.isExpanded,{},t.data)});case Y:return Object(j.a)({},e,{isTypeAheadLoading:t.data});case B:return Object(j.a)({},e,{options:t.data});case Q:return Object(j.a)({},e,{baseUrl:t.data});case q:return Object(j.a)({},e,{loading:t.data});case z:return Object(j.a)({},e,{showAlert:!e.showAlert});case N:return Object(j.a)({},e,{operationName:t.data});default:return e}}}),Be=a(82),Me=a(83),Xe=(Object(Me.createLogger)(),window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||Ie.d),Fe=[Be.a];var qe=Object(Ie.e)(He,Xe(Ie.a.apply(void 0,Fe))),Ge=function(e){var t=e.baseUrl;return r.a.createElement(c.a,{store:qe},r.a.createElement(xe.a,null,r.a.createElement(f.c,null,r.a.createElement(f.a,{path:"/",exact:!0,render:function(e){return r.a.createElement(we,Object.assign({},e,{baseUrl:t}))}}),r.a.createElement(f.a,{path:"/:operation(edit-shipment|add-shipment)/:productTypeOrId?",render:function(e){return r.a.createElement(we,Object.assign({},e,{baseUrl:t}))}}),r.a.createElement(f.a,{path:"".concat(t,"shipments/process/:operation(edit-shipment|add-shipment)/:productTypeOrId?"),render:function(e){return r.a.createElement(we,Object.assign({},e,{baseUrl:t}))}}))))},Ke=document.getElementById("root"),We=Ke.getAttribute("data-baseurl");o.a.render(r.a.createElement(Ge,{baseUrl:We}),Ke)},91:function(e,t,a){e.exports=a(139)}},[[91,1,2]]]);
//# sourceMappingURL=main.62509e42.chunk.js.map